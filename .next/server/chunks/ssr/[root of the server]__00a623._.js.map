{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 15, "column": 0}, "map": {"version":3,"sources":["file:///Users/ivarnycolaas/Documents/webdev/slowcinemaclub/lib/mongodb.ts"],"sourcesContent":["import { MongoClient, MongoClientOptions } from 'mongodb';\n\nif (!process.env.MONGODB_URI) {\n  throw new Error('Invalid/Missing environment variable: \"MONGODB_URI\"');\n}\n\nconst uri = process.env.MONGODB_URI;\nconst options: MongoClientOptions = {\n  maxPoolSize: 10,\n  minPoolSize: 5,\n  maxIdleTimeMS: 60000,\n  connectTimeoutMS: 10000,\n  socketTimeoutMS: 45000,\n};\n\nlet client: MongoClient;\nlet clientPromise: Promise<MongoClient>;\n\nif (process.env.NODE_ENV === 'development') {\n  // In development mode, use a global variable so that the value\n  // is preserved across module reloads caused by HMR (Hot Module Replacement).\n  const globalWithMongo = global as typeof globalThis & {\n    _mongoClientPromise?: Promise<MongoClient>;\n  };\n\n  if (!globalWithMongo._mongoClientPromise) {\n    client = new MongoClient(uri, options);\n    globalWithMongo._mongoClientPromise = client.connect();\n  }\n  clientPromise = globalWithMongo._mongoClientPromise;\n} else {\n  // In production mode, it's best to not use a global variable.\n  client = new MongoClient(uri, options);\n  clientPromise = client.connect();\n}\n\n// Export a module-scoped MongoClient promise. By doing this in a\n// separate module, the client can be shared across functions.\nexport default clientPromise;\n\n// Helper function to get a database instance\nexport async function getDb(dbName: string) {\n  const client = await clientPromise;\n  return client.db(dbName);\n}\n\n// Helper function to get a collection\nexport async function getCollection(dbName: string, collectionName: string) {\n  const db = await getDb(dbName);\n  return db.collection(collectionName);\n} "],"names":[],"mappings":";;;;;AAAA;;AAEA,IAAI,CAAC,QAAQ,GAAG,CAAC,WAAW,EAAE;IAC5B,MAAM,IAAI,MAAM;AAClB;AAEA,MAAM,MAAM,QAAQ,GAAG,CAAC,WAAW;AACnC,MAAM,UAA8B;IAClC,aAAa;IACb,aAAa;IACb,eAAe;IACf,kBAAkB;IAClB,iBAAiB;AACnB;AAEA,IAAI;AACJ,IAAI;AAEJ,wCAA4C;IAC1C,+DAA+D;IAC/D,6EAA6E;IAC7E,MAAM,kBAAkB;IAIxB,IAAI,CAAC,gBAAgB,mBAAmB,EAAE;QACxC,SAAS,IAAI,uGAAA,CAAA,cAAW,CAAC,KAAK;QAC9B,gBAAgB,mBAAmB,GAAG,OAAO,OAAO;IACtD;IACA,gBAAgB,gBAAgB,mBAAmB;AACrD,OAAO;;AAIP;uCAIe;AAGR,eAAe,MAAM,MAAc;IACxC,MAAM,SAAS,MAAM;IACrB,OAAO,OAAO,EAAE,CAAC;AACnB;AAGO,eAAe,cAAc,MAAc,EAAE,cAAsB;IACxE,MAAM,KAAK,MAAM,MAAM;IACvB,OAAO,GAAG,UAAU,CAAC;AACvB"}},
    {"offset": {"line": 56, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 62, "column": 0}, "map": {"version":3,"sources":["file:///Users/ivarnycolaas/Documents/webdev/slowcinemaclub/lib/utils/url.ts"],"sourcesContent":["export function getSlugFromUrl(url: string): string {\n  // Extract the last part of the URL after the last forward slash\n  const parts = url.split('/');\n  const lastPart = parts[parts.length - 1];\n  return lastPart || '';\n}\n"],"names":[],"mappings":";;;AAAO,SAAS,eAAe,GAAW;IACxC,gEAAgE;IAChE,MAAM,QAAQ,IAAI,KAAK,CAAC;IACxB,MAAM,WAAW,KAAK,CAAC,MAAM,MAAM,GAAG,EAAE;IACxC,OAAO,YAAY;AACrB"}},
    {"offset": {"line": 71, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 77, "column": 0}, "map": {"version":3,"sources":["file:///Users/ivarnycolaas/Documents/webdev/slowcinemaclub/app/components/MovieCard.tsx"],"sourcesContent":["'use client';\n\nimport Image from \"next/image\";\nimport Link from \"next/link\";\nimport { getSlugFromUrl } from '@/lib/utils/url';\n\nexport interface Movie {\n  _id: string;\n  title: string;\n  imagepreviewurl: string;\n  director: string;\n  year: string;\n  description: string;\n  rating: number;\n  updatedat: string;\n  url: string;\n  language: string;\n  duration: string;\n}\n\nexport function MovieCard({ movie, index }: { movie: Movie; index: number }) {\n  const slug = getSlugFromUrl(movie.url);\n\n  return (\n    <Link \n      href={`/reviews/${slug}`}\n      className=\"group block hover:opacity-95\"\n      aria-labelledby={`movie-title-${movie._id}`}\n      scroll={true}\n    >\n      <article className=\"space-y-4\" itemScope itemType=\"https://schema.org/Movie\">\n        <div className=\"aspect-[3/2] overflow-hidden rounded-lg bg-muted\">\n          <Image\n            src={movie.imagepreviewurl.replace('?w=600', '?w=1200')}\n            alt={`Movie still from ${movie.title} (${movie.year})`}\n            width={1200}\n            height={800}\n            className=\"object-cover w-full h-full transition-all duration-300 group-hover:scale-105 group-hover:brightness-90\"\n            loading={index < 6 ? \"eager\" : \"lazy\"}\n            sizes=\"(min-width: 1024px) 33vw, (min-width: 640px) 50vw, 100vw\"\n          />\n        </div>\n        <div className=\"space-y-2\">\n          <h2 \n            id={`movie-title-${movie._id}`}\n            className=\"text-lg font-medium leading-snug tracking-tight group-hover:text-primary\"\n            itemProp=\"name\"\n          >\n            {movie.title}\n          </h2>\n          <div className=\"flex flex-col gap-1\">\n            <p className=\"text-sm font-medium text-muted-foreground\">\n              {movie.director}\n            </p>\n            <div className=\"flex items-center gap-2 text-sm text-muted-foreground/80\">\n              {movie.rating > 0 && (\n                <>\n                  <span className=\"flex items-center gap-1\">\n                    <span className=\"text-yellow-400\">★</span>\n                    <span>{movie.rating}</span>\n                  </span>\n                  <span className=\"text-muted-foreground/60\">•</span>\n                </>\n              )}\n              <span>{movie.duration} min</span>\n              <span className=\"text-muted-foreground/60\">•</span>\n              <span>{movie.year}</span>\n            </div>\n          </div>\n        </div>\n      </article>\n    </Link>\n  );\n} "],"names":[],"mappings":";;;;AAEA;AACA;AACA;AAJA;;;;;AAoBO,SAAS,UAAU,EAAE,KAAK,EAAE,KAAK,EAAmC;IACzE,MAAM,OAAO,CAAA,GAAA,mHAAA,CAAA,iBAAc,AAAD,EAAE,MAAM,GAAG;IAErC,qBACE,8OAAC,4JAAA,CAAA,UAAI;QACH,MAAM,CAAC,SAAS,EAAE,MAAM;QACxB,WAAU;QACV,mBAAiB,CAAC,YAAY,EAAE,MAAM,GAAG,EAAE;QAC3C,QAAQ;kBAER,cAAA,8OAAC;YAAQ,WAAU;YAAY,SAAS;YAAC,UAAS;;8BAChD,8OAAC;oBAAI,WAAU;8BACb,cAAA,8OAAC,6HAAA,CAAA,UAAK;wBACJ,KAAK,MAAM,eAAe,CAAC,OAAO,CAAC,UAAU;wBAC7C,KAAK,CAAC,iBAAiB,EAAE,MAAM,KAAK,CAAC,EAAE,EAAE,MAAM,IAAI,CAAC,CAAC,CAAC;wBACtD,OAAO;wBACP,QAAQ;wBACR,WAAU;wBACV,SAAS,QAAQ,IAAI,UAAU;wBAC/B,OAAM;;;;;;;;;;;8BAGV,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;4BACC,IAAI,CAAC,YAAY,EAAE,MAAM,GAAG,EAAE;4BAC9B,WAAU;4BACV,UAAS;sCAER,MAAM,KAAK;;;;;;sCAEd,8OAAC;4BAAI,WAAU;;8CACb,8OAAC;oCAAE,WAAU;8CACV,MAAM,QAAQ;;;;;;8CAEjB,8OAAC;oCAAI,WAAU;;wCACZ,MAAM,MAAM,GAAG,mBACd;;8DACE,8OAAC;oDAAK,WAAU;;sEACd,8OAAC;4DAAK,WAAU;sEAAkB;;;;;;sEAClC,8OAAC;sEAAM,MAAM,MAAM;;;;;;;;;;;;8DAErB,8OAAC;oDAAK,WAAU;8DAA2B;;;;;;;;sDAG/C,8OAAC;;gDAAM,MAAM,QAAQ;gDAAC;;;;;;;sDACtB,8OAAC;4CAAK,WAAU;sDAA2B;;;;;;sDAC3C,8OAAC;sDAAM,MAAM,IAAI;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAO/B"}},
    {"offset": {"line": 239, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 245, "column": 0}, "map": {"version":3,"sources":["file:///Users/ivarnycolaas/Documents/webdev/slowcinemaclub/app/reviews/page.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useEffect, useRef } from \"react\";\nimport { getCollection } from \"@/lib/mongodb\";\nimport { MovieCard, Movie } from \"@/app/components/MovieCard\";\nimport { Document } from 'mongodb';\nimport { ChevronDown } from 'lucide-react';\n\n// Enable ISR with 1 hour revalidation\nexport const revalidate = 3600;\n\nasync function getAllMovies(): Promise<Movie[]> {\n  try {\n    const collection = await getCollection('scc', 'movies');\n    \n    const moviesRaw = await collection\n      .find(\n        {},\n        {\n          projection: {\n            _id: 1,\n            title: 1,\n            imagepreviewurl: 1,\n            director: 1,\n            year: 1,\n            description: 1,\n            rating: 1,\n            duration: 1,\n            updatedat: 1,\n            url: 1,\n            language: 1\n          },\n        }\n      )\n      .sort({ updatedat: -1 })\n      .toArray();\n\n    // Serialize MongoDB documents to plain objects and ensure all required fields are present\n    const movies: Movie[] = moviesRaw.map((movie: Document) => ({\n      _id: movie._id.toString(),\n      title: movie.title as string,\n      imagepreviewurl: movie.imagepreviewurl as string,\n      director: movie.director as string,\n      year: movie.year as string,\n      description: movie.description as string,\n      rating: movie.rating as number,\n      duration: movie.duration as string,\n      updatedat: movie.updatedat as string,\n      url: movie.url as string,\n      language: (movie.language as string) || ''\n    }));\n\n    return movies;\n  } catch (error) {\n    console.error('Error fetching movies:', error);\n    return [];\n  }\n}\n\ntype SortOption = 'added' | 'title' | 'year' | 'length' | 'rating';\n\nconst sortOptions = [\n  { value: 'added', label: 'Added (newest first)' },\n  { value: 'title', label: 'Title (alphabetical)' },\n  { value: 'year', label: 'Year (newest first)' },\n  { value: 'length', label: 'Length (longest first)' },\n  { value: 'rating', label: 'Rating (highest first)' }\n];\n\nfunction MovieGrid({ movies, sortBy }: { movies: Movie[], sortBy: SortOption }) {\n  // Sort movies based on the selected option\n  const sortedMovies = [...movies].sort((a, b) => {\n    switch (sortBy) {\n      case 'title':\n        return a.title.localeCompare(b.title);\n      case 'year':\n        return parseInt(b.year) - parseInt(a.year);\n      case 'length':\n        return parseInt(b.duration) - parseInt(a.duration);\n      case 'rating':\n        return b.rating - a.rating;\n      case 'added':\n      default:\n        return new Date(b.updatedat).getTime() - new Date(a.updatedat).getTime();\n    }\n  });\n\n  return (\n    <div className=\"grid gap-6 sm:grid-cols-2 lg:grid-cols-3\">\n      {sortedMovies.map((movie, index) => (\n        <MovieCard key={movie._id} movie={movie} index={index} />\n      ))}\n    </div>\n  );\n}\n\nexport default function ReviewsPage() {\n  const [movies, setMovies] = useState<Movie[]>([]);\n  const [sortBy, setSortBy] = useState<SortOption>('added');\n  const [isDropdownOpen, setIsDropdownOpen] = useState(false);\n  const [isLoading, setIsLoading] = useState(true);\n  const dropdownRef = useRef<HTMLDivElement>(null);\n\n  useEffect(() => {\n    const fetchMovies = async () => {\n      const fetchedMovies = await getAllMovies();\n      setMovies(fetchedMovies);\n      setIsLoading(false);\n    };\n\n    fetchMovies();\n  }, []);\n\n  useEffect(() => {\n    const handleClickOutside = (event: MouseEvent) => {\n      if (dropdownRef.current && !dropdownRef.current.contains(event.target as Node)) {\n        setIsDropdownOpen(false);\n      }\n    };\n\n    document.addEventListener('mousedown', handleClickOutside);\n    return () => {\n      document.removeEventListener('mousedown', handleClickOutside);\n    };\n  }, []);\n\n  const handleSortChange = (option: SortOption) => {\n    setSortBy(option);\n    setIsDropdownOpen(false);\n  };\n\n  return (\n    <div>\n      <div className=\"flex justify-between items-center mb-8\">\n        <h1 className=\"text-4xl font-serif\">Film Reviews</h1>\n        \n        <div className=\"relative\" ref={dropdownRef}>\n          <button\n            className=\"flex items-center gap-2 px-4 py-2 text-sm font-medium rounded-full bg-black/5 dark:bg-white/10 hover:bg-black/10 dark:hover:bg-white/15 transition-all border border-transparent hover:border-slate-200 dark:hover:border-slate-700 focus:outline-none focus:ring-2 focus:ring-slate-300 dark:focus:ring-slate-600\"\n            onClick={() => setIsDropdownOpen(!isDropdownOpen)}\n            aria-expanded={isDropdownOpen}\n            aria-haspopup=\"listbox\"\n            aria-controls=\"sort-options\"\n          >\n            <span>Sort: {sortOptions.find(option => option.value === sortBy)?.label}</span>\n            <ChevronDown className={`h-4 w-4 transition-transform duration-200 ${isDropdownOpen ? 'rotate-180' : ''}`} />\n          </button>\n          \n          {isDropdownOpen && (\n            <div \n              id=\"sort-options\"\n              role=\"listbox\"\n              className=\"absolute right-0 mt-2 w-64 bg-white dark:bg-gray-900 rounded-lg shadow-lg border border-slate-200 dark:border-slate-700 z-10 overflow-hidden transform origin-top-right transition-all animate-in fade-in-50 zoom-in-95 duration-100\"\n            >\n              <div className=\"py-1\">\n                {sortOptions.map((option) => (\n                  <button\n                    key={option.value}\n                    className={`w-full text-left px-4 py-2.5 text-sm transition-colors ${sortBy === option.value ? 'bg-slate-100 dark:bg-slate-800 font-medium text-primary' : 'hover:bg-slate-50 dark:hover:bg-slate-800'}`}\n                    onClick={() => handleSortChange(option.value as SortOption)}\n                    role=\"option\"\n                    aria-selected={sortBy === option.value}\n                  >\n                    {option.label}\n                  </button>\n                ))}\n              </div>\n            </div>\n          )}\n        </div>\n      </div>\n\n      {isLoading ? (\n        <div>Loading reviews...</div>\n      ) : (\n        <MovieGrid movies={movies} sortBy={sortBy} />\n      )}\n    </div>\n  );\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 494, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}